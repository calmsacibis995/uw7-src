#===============================================================================
#
#	ident @(#) gui.plan 11.2 97/12/04 
#
#******************************************************************************
#
#	Copyright (C) 1993-1997 The Santa Cruz Operation, Inc.
#		All Rights Reserved.
#
#	The information in this file is provided for the exclusive use of
#	the licensees of The Santa Cruz Operation, Inc.  Such users have the
#	right to use, modify, and incorporate this code into other products
#	for purposes authorized by the license agreement provided they include
#	this notice and the associated copyright notice with any such product.
#	The information in this file is provided "AS IS" without warranty.
#
#******************************************************************************
#
# Modification History
#
# M000, 26-Mar-97, andrean
#	- Created.
#
#===============================================================================

			Mail Admin GUI : Aliases Client
			  Test Plan for GUI portions
			-------------------------------

This is the semi-automated portion of the test plan.  The goal of this test 
plan, in conjuction with the "cmd" test portion, is to achieve 100% branch
coverage of tcl source files aliasFile.tcl and aliases.tcl.  Since some
of the gui portions can only be manually tested, this test plan implements
the idea of "semi-automation", meaning that scripts do the set up and
comparison of files, but the GUI steps must still be executed manually
according to a script.

Setup and Execution:

1) The env variable TESTDIR may be set to the directory in which the test
   script "gui" will exist and be run, and where input and output files
   for "gui" will exist.  If TESTDIR is not set in your env, the script will
   by default set it to the current working directory.  The following files
   are expected to exist in $TESTDIR:
        $TESTDIR/testfiles/aliases.1
        $TESTDIR/testfiles/aliases.2
        $TESTDIR/testfiles/aliases.3
        $TESTDIR/testfiles/aliases.4
        $TESTDIR/testfiles/aliases.5

2) Set env variable PROGDIR to the directory in which the "aliases"
   executable exists.  If PROGDIR is not set in your env, this script
   will by default set it to /etc/mail/admin.

   The "aliases" executable should be the instrumented version if you would
   like to determine code coverage of the aliases client:
         a) do a 'make aliasest' of the aliases src
         b) copy executable "aliasest" to $PROGDIR/aliases

3) Run the script "gui" as root to invoke the tests.
   Test results will be sent to stdout.
   If a test case fails, a prompt will be displayed on stdout, asking the
   tester if he/she wishes to re-execute this test-- this is in the event
   that the tester believes that the failure may be due to incorrect
   execution of the test steps.

4) To obtain complete coverage results, execute the cmd.plan test plan
   as well, before doing the following steps:
        a) Execution of the "cmd" and "gui" scripts will have created many
           files of the form trace.* into $TESTDIR.
        b) Copy *.tclt files from the src directory (generated by the make of
           aliasest) into the $TESTDIR directory.
        c) Execute the "do_merge" script, which will output coverage results
           to stdout, and also create files of the form *.tclt.a.  These
           *.tclt.a files are annotated versions of the source files--
           lines beginning with a ">_branch" in these files mark unexecuted
           branches.


The test cases, and step by step instructions, are as follows:

1. Add a new alias (aliases_gui_core_alias_add):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "mailengr-owner" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on the OK button of the Add Alias dialog.
		- An Error dialog should appear with the message "An alias 
		  with that name already exists".  In this Error dialog, click 
		  on the OK button to return to the Add Alias dialog.
		- Change the text in the Name field from "mailengr-owner"
		  to ":include:/file/path".
		- Click on the OK button.
		- An Error dialog should appear with the message "Alias names
		  cannot contain " ", ":" or "," characters".  In this Error
		  dialog, click on the OK button to return to the Add Alias 
		  dialog.
		- Change the text in the Name field to name "myNewAlias".
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

2. Remove an alias (aliases_gui_core_alias_remove):
	- Select the alias name "doprog" in the Aliases list.
	- Select menu option Aliases->Remove.
	- In the Question dialog, click on the OK button to remove alias
	  "doprog".
	- In the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

3. Remove all aliases (aliases_gui_core_alias_remove_all):
	- Remove all aliases: For each name name in the Aliases list, first
	  select it, then select Aliases->Remove, and then click OK in the
	  resulting "Really remove alias" Question dialog.
	- Select the Aliases menu:  Only the "Add", "Save", and "Exit" options
	  should be available.  The "Modify" and "Remove" menu options should
	  be stippled out.
	- Select the Members menu: Both menu options should be stippled out.
	- Select the Users menu: Both menu options should be stippled out.
	- In the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

4. Modify an alias (aliases_gui_core_alias_modify):
	- Select the alias name "doprog" in the Aliases list.
	- Select menu option Aliases->Modify.
	- In the Modify Alias dialog:
		- Change "doprog" to "doprogModified" in the "Name" text field.
		- Type the text "newMember1 newMember2" into the "Enter name(s)"
		  text field.  Then click on the "Add name(s)" button to add 
		  the new members to the list of recipients.
		- Click on the "Select name..." button to invoke the Select
		  User(s) dialog.  In the Select User(s) dialog:
			- Select the name "root" then click on the OK
			  button to exit the dialog and add "root" to the
			  Name list of the Modify Alias dialog.
		- In the Search text field, type in the letter "p".  The name
		  "patrick" should now be selected in the Name list.  Click on
		  the Remove button to remove the name "patrick".  The name
		  "root" should now be selected.
		- Select the following members in the Name list: audrey, frank,
		  and harry (the name "root" should NOT be selected).  Then 
		  click on the Remove button to remove these names from the 
		  list.  The name "cathy" should now be selected in the name 
		  list.
		- Select the member '"|mailprog -a -b -c arg1, arg2"' in the
		  Name list, and click on the Edit button to move the name
		  into the "Enter name(s)" text field.  Insert the text
		  "-d " before the text "arg1" -- so the member
		  has been changed from
			|"mailprog -a -b -c arg1, arg2"
		  to
			|"mailprog -a -b -c -d arg1, arg2"
		  Now click on the "Add name(s)" button to add this
		  modified member back to the Name list.
		- Click on the OK button to exit the Modify Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.
	
5. Save aliases file (aliases_gui_core_alias_save):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Click on the OK button of the Add Alias dialog.
		- In the resulting Error dialog, click on the OK button to
		  return to the Add Alias dialog.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Save.
	- In main screen, select menu option Aliases->Exit.
	
6. Save aliases file where valid database is specified
   (aliases_gui_core_alias_save_class):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

7. Save aliases file where file specified is a relative pathname 
   (aliases_gui_core_alias_save_relative_pathname):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

8. Exit aliases file -- do not save changes 
   (aliases_gui_core_alias_exit_no_save):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on No button.

9. Exit aliases file, with cancel (aliases_gui_core_alias_exit_cancel):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Cancel button.
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "secondAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"user1 user2"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button.

10. Add a new member to an alias (aliases_gui_core_member_add):
	- Select alias name "doprog" in the Aliases list.
	- Select menu option Members->Add.
	- In Add Member dialog:
		- Click on the OK button.  The resulting Error dialog should
		  say "You must add at least one member".  Click the OK button
		  in the Error dialog to exit it and return to the Add Member
		  dialog.
		- Type the name "newMember1" in the text field.
		- Click on the "Select name..." button.
		- In the Select User(s) dialog:
			- Select the name "root".
			- Click on the OK button.
		- Back in the Add Member dialog, add the following text to
		  the text field (type the text between single quotes):
		 ' |"newProg arg1, arg2" newMember2 \newMember3 :include: /file'
		  (be sure to include the space between the ":include:" and
		   "/file")
		- Click on the OK button.
	- In main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

11.  Remove a member from an alias (aliases_gui_core_member_remove):
	- Select the alias "mailengr-owner" in the Aliases list.  Its' member
	  "kurth" should be automatically selected in the Members list.
	- Select the menu option Members->Remove.  An Error dialog should
	  appear disallowing the removal.  Click on the OK button to exit the
	  Error dialog and return to the main screen.
	- Deselect the member "kurth" by first holding down the CTRL key,
	  while you click on the name "kurth".  The Members->Remove menu option
	  should be unavailable (stippled out).
	- In the Search text field below the Aliases list, type in the letter
	  "d".  The alias name "doprog" should now be selected in the Aliases
	  list.
	- Select member name "frank" in the Members list.
	- Select menu option Members->Remove.
	- In the Question dialog, click on the OK button to really remove
	  member "frank".  The member "harry" should now be selected.
	- In the Search text field below the Members list, type the character
	  "|".  The member name '|"mailprog -a -b -c arg1, arg2"' should now
	  be selected in the Members list.
	- Also select member name "audrey" in the Members list (still for alias
	  "doprog") by holding the CTRL key down while you click on the
	  name "audrey". Both member names '|"mailprog -a -b -c arg1, arg2"'
	  and "audrey" should now be selected in the Members list.
	- Select menu option Members->Remove.  The member "cathy" should now
	  be selected.  Deselect the member cathy.
	- Select member names "harry" and "patrick", and select menu option
	  Members->Remove.  
	- In the Question dialog with message "Really remove all selected
	  members?", click on the OK button to remove members.  The member 
	  name "cathy" should now be selected.
	- In the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

12. Subscribe users to aliases (aliases_gui_core_users_subscribe): 
	- Select menu option Users->Subscribe.
	- In the Select User(s) dialog:
		- Click on the OK button without having entered anything in
		  the text field.
	- Select menu option Users->Subscribe again.
	- In the Select User(s) dialog:
		- Type the following members into the text field:
			"cancelMem1 cancelMem2"
		- Click on the Cancel button to exit the dialog.
	- Select menu option Users->Subscribe again.
	- In the Select User(s) dialog:
		- Type the following members into the text field (type text
		  between the single quotes, exactly as below):
			'kurth subMember "|allprog arg1, arg2"'
		- Click on the Select button.
		- In the new dialog, select the user names "bin" and "daemon".
		  Now click on the Cancel button-- "bin" and "daemon" should 
		  not appear in the original Select Users(s) dialog.
		- Back in the first Select User(s) dialog, click on the Select 
		  button again.
		- In the new dialog, select the user names "adm" and "root".
		  Click on the OK button.
		- Back in the original Select User(s) dialog, click on
		  OK to subscribe all members in the text field.
	- In 'Subscribe user "|allprog arg1, arg2"' dialog:
		- Add all aliases from the "System aliases" list to the 
		  "Aliases ... subscribes to" list by first selecting them, 
		  then using the "ADD >>" button.
		- The following aliases should be in the subscribes to list:
		  "appendfile", "doprog", "mailengr", "mailengr-owner", and
		  "maintenance".   Click on the OK button to complete 
		  subscription.
	- In "Subscribe user adm" dialog:
		- Add aliases "appendfile", "mailengr", and "maintenance" from
		  the "System aliases" list to the "Aliases adm subscribes to"
		  list by first selecting them, then using the "ADD >>" button.
		- Remove the "maintenance" alias from the "subscribes to" list
		  by first selecting it, then clicking the "<< REMOVE" button.
		- There should only be the aliases "appendfile" and "mailengr"
		  in the "Aliases adm subscribes to" list.  Click on the
		  OK button to complete subscription for user "adm".
	- In "Subscribe user kurth" dialog:
		- The alias names "mailengr" and "mailengr-owner" should be in
		  the list of aliases kurth subscribes to.  Select the
		  alias "mailengr-owner", then click on the "<< REMOVE" button.
		  The alias "mailengr-owner" should have moved to the "System
		  aliases" list.
		- In the System aliases list, select the alias "appendfile"
		  and add it to the "... subscribes to" list by clicking on
		  the "ADD >>" button.  The "... subscribes to" list should
		  now contain the aliases "appendfile" and "mailengr"
		- Click on the OK button to complete subscription.
	- In "Subscribe user root" dialog:
		- Add aliases "doprog" and "maintenance" from the 
		  "System aliases" list to the "... subscribes to"
		  list by first selecting them, then using the "ADD >>" button.
		- There should be the aliases "doprog" and "maintenance"
		  in the "Aliases root subscribes to" list.  Click on the
		  Cancel button to close this dialog and cancel subscription.
	- In "Subscribe user subMember" dialog:
		- Add aliases "doprog" and "mailengr-owner" from the 
		  "System aliases" list to the "... subscribes to"
		  list by first selecting them, then using the "ADD >>" button.
		- There should only be the aliases "doprog" and "mailengr-owner"
		  in the "Aliases subMember subscribes to" list.  Click on the
		  OK button to complete subscription for user "subMember".
	- In the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

13.  Retire users (aliases_gui_core_users_retire): 
	- Select menu option Users->Retire.
	- In the Select User(s) dialog:
		- Click on the OK button without having entered anything in
		  the text field.
	- Select menu option Users->Retire again.
	- In the Select User(s) dialog:
		- Click on the Select button, and in the resulting
		  dialog, select the names "mail" and "root".  Click on the OK 
		  button to add these names to the original Select User(s)
		  dialog.
		- Add the following into the text field (text between single
		  quotes shown below):
		  ' "|allprog -a arg1, arg2" \iv kurth vince'
		- Click on the OK button.
	- In the 'Remove User mail' dialog:
		- Click on the option to redirect mail for mail.  This should
		  allow you to input into the text field below the option.
		- Now type in the text "sysadm" into the text field.
		- Click on the Cancel button.
	- In the 'Remove User root' dialog:
		- Click on the option to redirect mail for root.  This should
		  allow you to input into the text field below the option.
		- Type in the text '"|rootFilter -a" sysadm' into the text
		  below the option (only text between the single quotes).
		- Click on the OK button.
	- In the 'Remove User "|allprog -a arg1, arg2"' dialog:
		- Click on the OK button.
	- In the 'Remove User \iv' dialog:
		- Click on the OK button.
	- In the 'Remove User kurth' dialog:
		- Click on the option to redirect mail for kurth.  This should
		  allow you to input into the text field below the option.
		- Click on the OK button (without entering anything into the
		  text field).  An Error dialog should appear with the message
		  "You must specify a mail redirection address".  Click on the
		  OK button in this Error dialog to return to the Remove User
		  dialog.
		- Now type in the text "bob /etc/mail/retire/kurth" into the 
		  text field.
		- Click on the OK button.
	- In the 'Remove User vince' dialog:
		- Click on the option to redirect mail for vince.  This should
		  allow you to input into the text field below the option.
		- Now type in the text "rob /etc/mail/retire/vince" into the 
		  text field.
		- Click again on the checkbox for "Redirect mail for vince to:",		  which should deselect this option (the text field will become
		  unavailable).
		- Click on the OK button.
	- Back in the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

14. Create new, non-empty aliases file (aliases_gui_core_file_doesnt_exist):
	- The application should appear, with an information dialog saying
	  "File does not exist".  Click on the OK button in this information
	  dialog.
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- Back in the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.

15. Open alias file that doesn't exist, and exit 
    (aliases_gui_core_file_doesnt_exist_exit):
	- The application should appear, with an information dialog saying
	  "File does not exist".  Click on the OK button in this information
	  dialog.
	- In main screen, select menu option Aliases->Exit.

16. Open alias file that doesn't exist, and save without modifications
    (aliases_gui_core_file_doesnt_exist_empty):
	- The application should appear, with an information dialog saying
	  "File does not exist".  Click on the OK button in this information
	  dialog.
	- In main screen, select menu option Aliases->Save.
	- Select menu option Aliases->Exit.

17.  Open alias file with invalid database class specified 
     (aliases_gui_error_invalid_class):
	- The application should come up but with an Error dialog.
	  Click on the OK button in the Error dialog.  Both the Error dialog
	  and the application should exit.

18.  Open alias file where the filename specified is a directory
     (aliases_gui_error_directory):
	- The application should come up but with an Error dialog.
	  Click on the OK button in the Error dialog.  Both the Error dialog
	  and the application should exit.

19.  Test that a system error in saving the aliases file is properly caught
     and displayed in an error dialog (aliases_gui_error_save):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- Back in the main screen, select menu option Aliases->Save.
	- An error dialog should appear with the message "Failed to write alias
	  file: <filename>".  Click on the OK button of this error dialog.
	- Select menu option Aliases->Exit.
	- In Save Changes dialog, click on No button to exit.

20.  Test that a system error in creating the aliases database is
     properly caught and displayed in an error dialog 
     (aliases_gui_error_newaliases):
	- Select menu option Aliases->Add.
	- In Add Alias dialog:
		- Type name "myNewAlias" into the "Name" text field.
		- Type the following into the "Enter name(s)" text field:
			"member1 member2 member3"
		- Click on button "Add name(s)" to add above members to
		  the list of alias recipients.
		- Click on OK button to exit out of Add Alias dialog.
	- Back in the main screen, select menu option Aliases->Save.
	- An error dialog should appear with the message "Failed to create
	  alias database: <filename>".  Click on the OK button of this error 
	  dialog.
	- Select menu option Aliases->Exit.

21.  Test that a system error in loading (opening) the alias file is
     properly caught and displayed in an error dialog 
     (aliases_gui_error_alias_load):
	- The application should come up but with an Error dialog.
	- Ensure the error dialog lists the reason for the error.
	- Click on the OK button in the Error dialog.  Both the Error dialog
	  and the application should exit.

22.  Test that an unexpected error thrown will be properly caught and 
     displayed in an error dialog, then the application exits
     (aliases_gui_error_alias_unexpected):
	- Select menu option Aliases->Remove.
	- In the Question dialog with message 'Really remove alias
          "appendfile"?', click on the OK button to remove alias "appendfile".
	- Back in the main screen, select menu option Aliases->Exit.
	- In Save Changes dialog, click on Yes button to save changes and exit.
	- An error dialog should appear with the message "Unexpected error:
	  child process exited abnormally".  Click on the OK button of this 
	  error dialog.  The application should exit.
